# üìà Hybrid Volatility Prediction & Algorithmic Trading

–£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ—Å–≤—è—â–µ–Ω –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—é –≤—Å–ø–ª–µ—Å–∫–æ–≤ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä—ã–Ω–∫–∞—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–Ω—Å–∞–º–±–ª—è –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏ –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.

–í —Ö–æ–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç –ø—Ä–æ—à–µ–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ –∏ —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### üõ† –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (Change Log):

1.  **–ë–æ—Ä—å–±–∞ —Å —É—Ç–µ—á–∫–æ–π –¥–∞–Ω–Ω—ã—Ö (Data Leakage Prevention):**
      * –í–Ω–µ–¥—Ä–µ–Ω `shift(1)` –¥–ª—è –≤—Å–µ—Ö –ª–∞–≥–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –†–∞–Ω–µ–µ –º–æ–¥–µ–ª—å –º–æ–≥–ª–∞ ¬´–ø–æ–¥–≥–ª—è–¥—ã–≤–∞—Ç—å¬ª –≤ –±—É–¥—É—â–µ–µ —á–µ—Ä–µ–∑ —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è High/Low, —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ "–∑–∞–≤—Ç—Ä–∞" —Å—Ç—Ä–æ–∏—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö "—Å–µ–≥–æ–¥–Ω—è".
2.  **–ß–µ—Å—Ç–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫:**
      * –ò—Å–∫–ª—é—á–µ–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏ —Å –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–µ–π —Å —Ç–∞—Ä–≥–µ—Ç–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Future_Vol`).
      * **–†–µ–∑—É–ª—å—Ç–∞—Ç:** ROC-AUC —Å–Ω–∏–∑–∏–ª—Å—è —Å –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö **0.99** (–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ) –¥–æ —á–µ—Å—Ç–Ω—ã—Ö **0.66**, —á—Ç–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω—É—é —Å–∏–ª—É –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä—ã–Ω–æ—á–Ω–æ–º —à—É–º–µ.
3.  **–†–∞–±–æ—Ç–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤:**
      * –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `class_weight='balanced'` –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –≤–µ—Å–∞ –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∏ XGBoost.
      * –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ **L2-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –Ω–∞ –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω–æ–º –∫–ª–∞—Å—Å–µ.
4.  **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞:**
      * –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–∏–æ–¥ —É–≤–µ–ª–∏—á–µ–Ω: –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è —Å **2015 –≥–æ–¥–∞** (–≤–º–µ—Å—Ç–æ 2020). –≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏–ª–æ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Ä–∞–∑–Ω—ã–µ —Ä—ã–Ω–æ—á–Ω—ã–µ —Ü–∏–∫–ª—ã.
      * **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Precision (—Ç–æ—á–Ω–æ—Å—Ç—å) –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –≤—ã—Ä–æ—Å–ª–∞ —Å **0.10** –¥–æ **0.17**.
5.  **–ì–∏–±—Ä–∏–¥–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å (Ensemble Learning):**
      * –í–º–µ—Å—Ç–æ –æ–¥–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Ä–∞–∑–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –¥–ª—è —É—á–µ—Ç–∞ –ª–∏–Ω–µ–π–Ω—ã—Ö, –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
6.  **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–∞ (Threshold Tuning):**
      * –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ü–∏–∫–ª –ø–µ—Ä–µ–±–æ—Ä–∞ `threshold` (–æ—Ç 0.01 –¥–æ 0.41) –¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ **F1-Score**. –ú–æ–¥–µ–ª—å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–æ—Ä–æ–≥ 0.5, –∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Ç–µ–∫—É—â—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å.

-----

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

–†–µ—à–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–∏–ø | –†–æ–ª—å –≤ –∞–Ω—Å–∞–º–±–ª–µ |
| :--- | :--- | :--- |
| **Logistic Regression** | Linear | –ë–∞–∑–æ–≤–∞—è –ª–∏–Ω–∏—è (Baseline), –≤—ã—è–≤–ª—è–µ—Ç –ª–∏–Ω–µ–π–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã. |
| **XGBoost** | Gradient Boosting | –†–∞–±–æ—Ç–∞ —Å —Ç–∞–±–ª–∏—á–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –ø–æ–∏—Å–∫ —Å–ª–æ–∂–Ω—ã—Ö –Ω–µ–ª–∏–Ω–µ–π–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤. |
| **LSTM (Keras)** | Deep Learning | –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π (Look-back window = 10 –¥–Ω–µ–π). |
| **DBSCAN + KNN** | Unsupervised | –î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π "–±–µ–∑ —É—á–∏—Ç–µ–ª—è". –í—ã–±—Ä–æ—Å—ã, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–µ–π, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ `boost_factor` –∫ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏. |

### –§–æ—Ä–º—É–ª–∞ –∞–Ω—Å–∞–º–±–ª—è

–ò—Ç–æ–≥–æ–≤–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫:

$$P_{final} = (W_{lr} \cdot P_{lr}) + (W_{xgb} \cdot P_{xgb}) + (W_{lstm} \cdot P_{lstm}) + (Signal_{dbscan} \cdot Boost)$$

*–ì–¥–µ –≤–µ—Å–∞ $W$ –ø–æ–¥–æ–±—Ä–∞–Ω—ã —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏ (LR: 0.5, XGB: 0.2, LSTM: 0.3).*

-----

## üìâ –¢–æ—Ä–≥–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ (Backtesting)

–ù–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–≥–Ω–æ–∑–∞ `Target_Volatility_Spike` –±—ã–ª–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã —Ç—Ä–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º:

### 1\. Buy & Hold (Benchmark)

  * –ü—Ä–æ—Å—Ç–æ–µ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–∞.

### 2\. Soft Hedge

  * –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–ø–ª–µ—Å–∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ ‚Äî –ø–æ–∑–∏—Ü–∏—è —Å–æ–∫—Ä–∞—â–∞–µ—Ç—Å—è –Ω–∞ 50% (–≤—ã—Ö–æ–¥ –≤ –∫—ç—à).
  * –°–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫, –Ω–æ —Ä–µ–∂–µ—Ç –ø—Ä–æ—Ñ–∏—Ç –Ω–∞ –±—ã—á—å–µ–º —Ä—ã–Ω–∫–µ.

### 3\. Smart Trend Filter (Best Performance) 

  * **–õ–æ–≥–∏–∫–∞:** –ú—ã –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Ä—ã–Ω–∫–∞ **—Ç–æ–ª—å–∫–æ** –µ—Å–ª–∏:
    1.  –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (`Signal == 1`).
    2.  –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –Ω–∏–∂–µ 50-–¥–Ω–µ–≤–Ω–æ–π —Å—Ä–µ–¥–Ω–µ–π (`Close < SMA_50`), —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –Ω–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥.
  * –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å "–ª–æ–∂–Ω—ã–µ —Ç—Ä–µ–≤–æ–≥–∏" –º–æ–¥–µ–ª–∏ –≤–æ –≤—Ä–µ–º—è —Å–∏–ª—å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞ —Ä—ã–Ω–∫–∞.

-----

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
–ü—Ä–æ–µ–∫—Ç —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–∏–π –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è. –ù–µ–æ–±—Ö–æ–¥–∏–º —Ç—â–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ–¥–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ LSTM –í–Ω–µ–¥—Ä–∏—Ç—å –∞–Ω—Å–∞–º–±–ª—å LSTM (–æ–±—É—á–∏—Ç—å 5-10 –º–æ–¥–µ–ª–µ–π —Å —Ä–∞–∑–Ω—ã–º–∏ random seeds –∏ —É—Å—Ä–µ–¥–Ω–∏—Ç—å –∏—Ö –ø—Ä–æ–≥–Ω–æ–∑—ã).
–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–π –∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è. —Å–æ–∑–¥–∞–Ω–∏–µ –±–æ–ª–µ–µ —Ö–∏—Ç—Ä–æ–≥–æ –∞–Ω—Å–∞–º–±–ª—è –º–æ–¥–µ–ª–µ–π. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–≥ –±–æ—Ç–∞ –¥–ª—è –ø–æ–ª—É—á–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –≤—Å–ø–ª–µ—Å–∫–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

*–ì—Ä–∞—Ñ–∏–∫–∏ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π:*
<img width="1381" height="682" alt="image" src="https://github.com/user-attachments/assets/97453d31-359a-48dc-833c-b6af6f68a054" />

–ü—Ä–∏–º–µ—Ä –º–µ—Ç—Ä–∏–∫ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:

  * **ROC-AUC:** \~0.87
  * **Precision:** \~0.17
-----


### –ó–∞–ø—É—Å–∫
    –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
    python Project_vol.py

